package ComponentsFactory;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.ui.Select;
import org.testng.Reporter;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.openqa.selenium.support.ui.ExpectedConditions;

import LocatorsFactory.LoginPageLocators;
import LocatorsFactory.CourseApplicationHDRLocators;

public class CourseApplicationHDR {
	
	// perform desired operations on HDR course application page
	public void courseApplication(WebDriver driver,String CommYear, String Campus, String Course, String ModeOfDelivery, String Session, String Enrollment, String SupervisorName, String Faculty, String AcademicUnit) throws InterruptedException {
		
		// explicit wait - to wait for the element to be click-able
		WebDriverWait wait = new WebDriverWait(driver,60);
		if(!(CommYear.equalsIgnoreCase("NA"))) {
			new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.commencementYearDropdown))).selectByVisibleText(CommYear);
		}
		
		if(!(Campus.equalsIgnoreCase("NA"))) {
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(CourseApplicationHDRLocators.campusDropdown)));
		Thread.sleep(2000);
		new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.campusDropdown))).selectByVisibleText(Campus);
		}
		
		if(!(Course.equalsIgnoreCase("NA"))) {
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(CourseApplicationHDRLocators.courseDropdown)));
		Thread.sleep(2000);
		new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.courseDropdown))).selectByVisibleText(Course);		
		}
		
		if(!(ModeOfDelivery.equalsIgnoreCase("NA"))) {
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(CourseApplicationHDRLocators.modeOfDeliveryDropdown)));
		Thread.sleep(2000);
		new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.modeOfDeliveryDropdown))).selectByVisibleText(ModeOfDelivery);
		}
		
		if(!(Session.equalsIgnoreCase("NA"))) {
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(CourseApplicationHDRLocators.sessionDropdown)));
		Thread.sleep(2000);
		new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.sessionDropdown))).selectByVisibleText(Session);
		}
		
		if(Enrollment.equalsIgnoreCase("PartTime")) {
			driver.findElement(By.xpath(CourseApplicationHDRLocators.enrollmentPT)).click();
		} else {
			driver.findElement(By.xpath(CourseApplicationHDRLocators.enrollmentFT)).click();
		}
		
		
		if(!(SupervisorName.equalsIgnoreCase("NA"))) {
			driver.findElement(By.xpath(CourseApplicationHDRLocators.supervisor)).sendKeys(SupervisorName);
		}
		
		if(!(Faculty.equalsIgnoreCase("NA"))) {
			new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.facultyUnit))).selectByVisibleText(Faculty);
			Thread.sleep(2000);
		}
		
		if(!(AcademicUnit.equalsIgnoreCase("NA"))) {
//			wait.until(ExpectedConditions.elementToBeClickable(By.xpath(CourseApplicationHDRLocators.academicUnit)));
			new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.academicUnit))).selectByVisibleText(AcademicUnit);
			Thread.sleep(2000);
			new Select(driver.findElement(By.xpath(CourseApplicationHDRLocators.academicUnit))).selectByVisibleText(AcademicUnit);
		}
		
		driver.findElement(By.xpath(LoginPageLocators.next)).click();
		Thread.sleep(2000);

		Reporter.log("Enter Course Application details - Passed.");
	}

}
