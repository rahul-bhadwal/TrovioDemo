package ComponentsFactory;

import java.awt.AWTException;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Reporter;

import CommonUtilities.GenericMethods;
import CredentialStore.CredentialStores;
import LocatorsFactory.LoginPageLocators;
import LocatorsFactory.AcademicBackgroundLocators;

public class AcademicBackgroundHDR {
	GenericMethods GM;
	String p1, p2;
	
	public AcademicBackgroundHDR() {
		GM = new GenericMethods();
	}
	
	// perform desired operations on HDR academic background page
	public void academicBackground(WebDriver driver, String CountryAQ, String Institution, String Qualification, String Duration, String Comp, String DateComp, String MonthComp, String YearComp, String GPA, String FileName2, String FileName3, String ResearchPublication, String ResearchExperience, String AcadPrizeAward, String TuitionFees, String LivingExpenses) throws InterruptedException, AWTException {
		
		// explicit wait - to wait for the element to be click-able
		WebDriverWait wait = new WebDriverWait(driver,30);
				
		new Select(driver.findElement(By.xpath(AcademicBackgroundLocators.acadCountryDropdown))).selectByVisibleText(CountryAQ);
		driver.findElement(By.xpath(AcademicBackgroundLocators.institution)).sendKeys(Institution);
		driver.findElement(By.xpath(AcademicBackgroundLocators.qualification)).sendKeys(Qualification);
		driver.findElement(By.xpath(AcademicBackgroundLocators.duration)).sendKeys(Duration);
		
		if(Comp.equalsIgnoreCase("Yes")) {
			driver.findElement(By.xpath(AcademicBackgroundLocators.comp)).click();
			Thread.sleep(1000);
			driver.findElement(By.xpath(AcademicBackgroundLocators.dateComp)).sendKeys(DateComp);
			driver.findElement(By.xpath(AcademicBackgroundLocators.yearComp)).sendKeys(YearComp);
			driver.findElement(By.xpath(AcademicBackgroundLocators.gPA)).sendKeys(GPA);
			
			new Select(driver.findElement(By.xpath(AcademicBackgroundLocators.monthCompDropdown))).selectByVisibleText(MonthComp);
		}
		   
		p1 = CredentialStores.UploadFileLocation + FileName2;
		GM.fileUpload(driver, By.xpath(AcademicBackgroundLocators.acadUpload),p1);
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(AcademicBackgroundLocators.acadAddFile)));
		Thread.sleep(3000);
		driver.findElement(By.xpath(AcademicBackgroundLocators.acadAddFile)).click();
		Thread.sleep(2000);
		
		p2 = CredentialStores.UploadFileLocation + FileName3;
		GM.fileUpload(driver, By.xpath(AcademicBackgroundLocators.researchUpload),p2);
		wait.until(ExpectedConditions.elementToBeClickable(By.xpath(AcademicBackgroundLocators.researchAddFile)));
		Thread.sleep(3000);
		driver.findElement(By.xpath(AcademicBackgroundLocators.researchAddFile)).click();
		Thread.sleep(2000);
		
		driver.findElement(By.xpath(AcademicBackgroundLocators.researchPublication)).sendKeys(ResearchPublication);
		driver.findElement(By.xpath(AcademicBackgroundLocators.researchExperience)).sendKeys(ResearchExperience);
		driver.findElement(By.xpath(AcademicBackgroundLocators.acadPrizeAward)).sendKeys(AcadPrizeAward);
		driver.findElement(By.xpath(AcademicBackgroundLocators.tutionFees)).sendKeys(TuitionFees);
		driver.findElement(By.xpath(AcademicBackgroundLocators.livingExpenses)).sendKeys(LivingExpenses);
		
		driver.findElement(By.xpath(LoginPageLocators.next)).click();
		
		Thread.sleep(2000);
		Reporter.log("Academic background page created");
	}

}
